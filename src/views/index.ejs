<!doctype html>
<html lang="en">
<head>
	<meta charset="utf-8" />
	<link rel="apple-touch-icon" sizes="76x76" href="/img/zto.jpg">
	<link rel="icon" type="image/jpeg" href="/img/zto.jpg">
	<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />

	<title>실습평가 | 프로그래밍입문</title>

    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />
    
    <!-- Theme Color -->
    <meta name="theme-color" content="#87CEFA">
    <!-- Open Graph -->
    <meta property="og:title" content="실습평가 | 프로그래밍입문">
    <meta property="og:description" content="실습평가 자동 채점기 by rapsealk.">
    <meta property="og:image" content="/img/venezia.jpg">

	<!--     Fonts and icons     -->
	<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons" />
    <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700" />
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/latest/css/font-awesome.min.css" />

	<!-- CSS Files -->
    <link href="/css/bootstrap.min.css" rel="stylesheet" />
    <link href="/css/material-kit.css" rel="stylesheet"/>

    <!-- Monaco Editor -->
    <link rel="stylesheet" data-name="vs/editor/editor.main" href="/monaco/min/vs/editor/editor.main.css">
</head>

<body class="signup-page">
	<nav class="navbar navbar-transparent navbar-absolute">
    	<div class="container">
        	<!-- Brand and toggle get grouped for better mobile display -->
        	<div class="navbar-header">
        		<button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#navigation-example">
            		<span class="sr-only">Toggle navigation</span>
		            <span class="icon-bar"></span>
		            <span class="icon-bar"></span>
		            <span class="icon-bar"></span>
        		</button>
        		<a class="navbar-brand" href="/">프로그래밍입문 실습평가</a>
        	</div>

        	<div class="collapse navbar-collapse" id="navigation-example">
        		<ul class="nav navbar-nav navbar-right">
                    <!-- TODO: Quiz
                    < weeks.forEach(week => { >
                    <li>
                        <a data-placement="bottom" href="/?week=<= week >" class="btn btn-white btn-simple btn-just-icon">
                            week <= week >
                        </a>
                    </li>
                    < }); >
                    -->
                    <li>
                        <a data-placement="bottom" href="/quiz/1" class="btn btn-white btn-simple btn-just-icon">
                            Quiz 1
                        </a>
                    </li>
                    
                    <li>
                        <a data-placement="bottom" href="/" class="btn btn-white btn-simple btn-just-icon" style="background-color: black;">
                            <%= studentNumber %>
                        </a>
                    </li>
					<!--li>
						<a rel="tooltip" title="Follow and star me on Github" data-placement="bottom" href="https://github.com/rapsealk/zero-to-one" target="_blank" class="btn btn-white btn-simple btn-just-icon">
							<i class="fa fa-github"></i>
						</a>
					</li-->
        		</ul>
        	</div>
    	</div>
    </nav>

    <div class="wrapper">
		<div class="header header-filter" style="background-image: url('/img/venezia.jpg'); background-size: cover; background-position: top center;">
			<div class="container" id="main-container">
				<div class="row">
					<div class="col-md-12">
						<div class="card card-signup">
							<form class="form" action="#!">
								<div class="header header-info text-center">
									<h4>gcc <%= gcc %></h4>
								</div>
								<div class="content">
									<div class="input-group col-md-8">
                                        <div id="container" style="width:1080px;height:540px;border:1px solid grey"></div>
                                    </div>
                                    <div class="col-md-6 col-sm-offset-4">
                                        <div class="col-sm-12"></div>
                                        <button type="button" class="btn btn-warning" data-toggle="modal" data-target="#how">주의사항</button>            
                                        <button type="button" class="btn btn-info" id="btn-submit">제출하기</button>
                                    </div>
                                </div>
                                <!-- For comment..?
								<div class="row text-center">
									<div class="col-md-8 col-md-offset-2">
										<a class="btn btn-info btn-simple" href="#!">Sign up</a>
									</div>
                                </div>
                                -->
							</form>
						</div>
                    
                        <!-- alert -->
                        <div id="alert-zone"></div>
                    
                    </div>
				</div>
            </div>
            
            <!-- Modal Core -->
            <div class="modal fade" id="how" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                <div class="modal-dialog">
                    <div class="modal-content">
                        <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title" id="myModalLabel">사용설명서</h4>
                        </div>
                        <div class="modal-body">
                            <div class="row col-md-12">
                                입출력만 해주세요.
                            </div>
                            <hr>
                            <!-- Dynamic request -->
                            <div class="col-md-6">
                                <pre class="prettyprint" id="sample-input"></pre>
                            </div>
                            <div class="col-md-6">
                                <pre class="prettyprint" id="sample-output"></pre>
                            </div>                    
                        </div>
                        <div class="modal-footer">
                            <button type="button" class="btn btn-info btn-simple" data-dismiss="modal">닫기</button>
                        </div>
                    </div>
                </div>
            </div>

			<footer class="footer">
		        <div class="container">
		            <nav class="pull-left">
						<ul>
							<li>
								<a href="https://rapsealk.tistory.com">
								   Blog
								</a>
							</li>
						</ul>
		            </nav>
		            <div class="copyright pull-right">
		                &copy; <%= new Date().getFullYear() %>, made with <i class="fa fa-heart heart"></i> by <a href="https://github.com/rapsealk" target="_blank">Kang</a>
		            </div>
		        </div>
		    </footer>
		</div>
    </div>
</body>

    <!-- socket.io -->
    <script src="/socket.io/socket.io.js"></script>
    
    <!--   Core JS Files   -->
	<script src="/js/jquery.min.js" type="text/javascript"></script>
	<script src="/js/bootstrap.min.js" type="text/javascript"></script>
	<script src="/js/material.min.js"></script>

	<!-- Control Center for Material Kit: activating the ripples, parallax effects, scripts from the example pages etc -->
    <script src="/js/material-kit.js" type="text/javascript"></script>
    
    <!-- Monaco Editor -->
	<script>var require = { paths: { 'vs': '/monaco/min/vs' } };</script>
	<script src="/monaco/min/vs/loader.js"></script>
	<script src="/monaco/min/vs/editor/editor.main.nls.js"></script>
    <script src="/monaco/min/vs/editor/editor.main.js"></script>
    
    <script type="text/javascript">
        document.addEventListener('DOMContentLoaded', function(event) {
            // Monaco Editor
            var editor = monaco.editor.create(document.getElementById('container'), {
				value: [
					'#include <stdio.h>',
					'',
					'int main(int argc, char* argv[])',
					'{',
					'	printf("Hello, world!\\n");',
					'	return 0;',
					'}'
				].join('\n'),
				language: 'c'
            });

            // TODO: IO sample data
            /*
            $.get('/samples?week=<= week >', function(snapshot) {
                document.getElementById('sample-input').innerHTML = snapshot.data.inputs.join('<br>');
                document.getElementById('sample-output').innerHTML = snapshot.data.outputs.join('<br>');
            });
            */

            // Alert Generator
            // type: [success, warning, danger]
            // icon: warning check error_outline
            const alertClass = ['success', 'warning', 'danger'];
            const iconClass = ['check', 'warning', 'error_outline'];
            function alertNodeGenerator(type, message) {

                var rootNode = document.createElement('div');
                rootNode.className = 'alert alert-' + type;
                
                var alertNode = document.createElement('div');
                alertNode.className = 'container-fluid';
                
                var alertIconDiv = document.createElement('div');
                alertIconDiv.className = 'alert-icon';
                
                var iconNode = document.createElement('i');
                iconNode.className = 'material-icons';
                iconNode.innerText = iconClass[alertClass.indexOf(type)];
                alertIconDiv.appendChild(iconNode);
                
                var buttonNode = document.createElement('button');
                buttonNode.type = 'button';
                buttonNode.className = 'close';
                buttonNode.setAttribute('data-dismiss', 'alert');
                buttonNode.setAttribute('aria-label', 'Close');
                
                var spanNode = document.createElement('span');
                spanNode.setAttribute('aria-hidden', true);
                
                var spanINode = document.createElement('i');
                spanINode.className = 'material-icons';
                spanINode.innerText = 'clear';
                spanNode.appendChild(spanINode);
                
                buttonNode.appendChild(spanNode);
                
                alertNode.append(message);
                alertNode.appendChild(buttonNode);
                
                rootNode.appendChild(alertNode);

                document.getElementById('alert-zone').appendChild(rootNode);
            }

            // socket.io
            var socket = io();
            var submitButton = document.getElementById('btn-submit');

            socket.on('cperror', data => {
                alertNodeGenerator('danger', data);
                submitButton.disabled = false;
            });

            socket.on('exerror', data => {
                alertNodeGenerator('warning', data);
                submitButton.disabled = false;
            });

			socket.on('correct', data => {
				alertNodeGenerator('info', data);
				submitButton.disabled = false;
			});

            submitButton.addEventListener('click', function(e) {
				// lock
                submitButton.disabled = true;
				document.getElementById('alert-zone').innerHTML = '';
                socket.emit('data', {
                    // TODO
                    // week: "<= week >",
                    code: editor.getValue()
                });
            });
        });
    </script>

</html>
